{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alejandro/Desktop/Portfolio/project_e_commerce-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alejandro/Desktop/Portfolio/project_e_commerce-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/alejandro/Desktop/Portfolio/project_e_commerce-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{CssBaseline,Paper,Stepper,Step,StepLabel,Typography,CircularProgress,Divider,Button}from'@material-ui/core';import{Link,useHistory}from'react-router-dom';import{commerce}from'../../../lib/commerce';import AddressForm from'../AddressForm';import PaymentForm from'../PaymentForm';import useStyles from'./styles';var steps=['Shipping address','Payment details'];var Checkout=function Checkout(_ref){var cart=_ref.cart,onCaptureCheckout=_ref.onCaptureCheckout,order=_ref.order,error=_ref.error;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),checkoutToken=_useState2[0],setCheckoutToken=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),activeStep=_useState4[0],setActiveStep=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),shippingData=_useState6[0],setShippingData=_useState6[1];var classes=useStyles();var history=useHistory();var nextStep=function nextStep(){return setActiveStep(function(prevActiveStep){return prevActiveStep+1;});};var backStep=function backStep(){return setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};useEffect(function(){if(cart.id){var generateToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return commerce.checkout.generateToken(cart.id,{type:'cart'});case 3:token=_context.sent;setCheckoutToken(token);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);if(activeStep!==steps.length)history.push('/');case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function generateToken(){return _ref2.apply(this,arguments);};}();generateToken();}},[cart]);var test=function test(data){setShippingData(data);nextStep();};var Confirmation=function Confirmation(){return order.customer?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{variant:\"h5\"},\"Thank you for your purchase, \",order.customer.firstname,\" \",order.customer.lastname,\"!\"),/*#__PURE__*/React.createElement(Divider,{className:classes.divider}),/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle2\"},\"Order ref: \",order.customer_reference)),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Button,{component:Link,variant:\"outlined\",type:\"button\",to:\"/\"},\"Back to home\")):/*#__PURE__*/React.createElement(\"div\",{className:classes.spinner},/*#__PURE__*/React.createElement(CircularProgress,null));};if(error){Confirmation=function Confirmation(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Typography,{variant:\"h5\"},\"Error: \",error),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Button,{component:Link,variant:\"outlined\",type:\"button\",to:\"/\"},\"Back to home\"));};}var Form=function Form(){return activeStep===0?/*#__PURE__*/React.createElement(AddressForm,{checkoutToken:checkoutToken,nextStep:nextStep,setShippingData:setShippingData,test:test}):/*#__PURE__*/React.createElement(PaymentForm,{checkoutToken:checkoutToken,nextStep:nextStep,backStep:backStep,shippingData:shippingData,onCaptureCheckout:onCaptureCheckout});};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(CssBaseline,null),/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbar}),/*#__PURE__*/React.createElement(\"main\",{className:classes.layout},/*#__PURE__*/React.createElement(Paper,{className:classes.paper},/*#__PURE__*/React.createElement(Typography,{variant:\"h4\",align:\"center\"},\"Checkout\"),/*#__PURE__*/React.createElement(Stepper,{activeStep:activeStep,className:classes.stepper},steps.map(function(label){return/*#__PURE__*/React.createElement(Step,{key:label},/*#__PURE__*/React.createElement(StepLabel,null,label));})),activeStep===steps.length?/*#__PURE__*/React.createElement(Confirmation,null):checkoutToken&&/*#__PURE__*/React.createElement(Form,null))));};export default Checkout;","map":{"version":3,"sources":["/Users/alejandro/Desktop/Portfolio/project_e_commerce-main/src/components/CheckoutForm/Checkout/Checkout.jsx"],"names":["React","useState","useEffect","CssBaseline","Paper","Stepper","Step","StepLabel","Typography","CircularProgress","Divider","Button","Link","useHistory","commerce","AddressForm","PaymentForm","useStyles","steps","Checkout","cart","onCaptureCheckout","order","error","checkoutToken","setCheckoutToken","activeStep","setActiveStep","shippingData","setShippingData","classes","history","nextStep","prevActiveStep","backStep","id","generateToken","checkout","type","token","length","push","test","data","Confirmation","customer","firstname","lastname","divider","customer_reference","spinner","Form","toolbar","layout","paper","stepper","map","label"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { CssBaseline, Paper, Stepper, Step, StepLabel, Typography, CircularProgress, Divider, Button } from '@material-ui/core';\nimport { Link, useHistory } from 'react-router-dom';\n\nimport { commerce } from '../../../lib/commerce';\nimport AddressForm from '../AddressForm';\nimport PaymentForm from '../PaymentForm';\nimport useStyles from './styles';\n\nconst steps = ['Shipping address', 'Payment details'];\n\nconst Checkout = ({ cart, onCaptureCheckout, order, error }) => {\n  const [checkoutToken, setCheckoutToken] = useState(null);\n  const [activeStep, setActiveStep] = useState(0);\n  const [shippingData, setShippingData] = useState({});\n  const classes = useStyles();\n  const history = useHistory();\n\n  const nextStep = () => setActiveStep((prevActiveStep) => prevActiveStep + 1);\n  const backStep = () => setActiveStep((prevActiveStep) => prevActiveStep - 1);\n\n  useEffect(() => {\n    if (cart.id) {\n      const generateToken = async () => {\n        try {\n          const token = await commerce.checkout.generateToken(cart.id, { type: 'cart' });\n\n          setCheckoutToken(token);\n        } catch {\n          if (activeStep !== steps.length) history.push('/');\n        }\n      };\n\n      generateToken();\n    }\n  }, [cart]);\n\n  const test = (data) => {\n    setShippingData(data);\n\n    nextStep();\n  };\n\n  let Confirmation = () => (order.customer ? (\n    <>\n      <div>\n        <Typography variant=\"h5\">Thank you for your purchase, {order.customer.firstname} {order.customer.lastname}!</Typography>\n        <Divider className={classes.divider} />\n        <Typography variant=\"subtitle2\">Order ref: {order.customer_reference}</Typography>\n      </div>\n      <br />\n      <Button component={Link} variant=\"outlined\" type=\"button\" to=\"/\">Back to home</Button>\n    </>\n  ) : (\n    <div className={classes.spinner}>\n      <CircularProgress />\n    </div>\n  ));\n\n  if (error) {\n    Confirmation = () => (\n      <>\n        <Typography variant=\"h5\">Error: {error}</Typography>\n        <br />\n        <Button component={Link} variant=\"outlined\" type=\"button\" to=\"/\">Back to home</Button>\n      </>\n    );\n  }\n\n  const Form = () => (activeStep === 0\n    ? <AddressForm checkoutToken={checkoutToken} nextStep={nextStep} setShippingData={setShippingData} test={test} />\n    : <PaymentForm checkoutToken={checkoutToken} nextStep={nextStep} backStep={backStep} shippingData={shippingData} onCaptureCheckout={onCaptureCheckout} />);\n\n  return (\n    <>\n      <CssBaseline />\n      <div className={classes.toolbar} />\n      <main className={classes.layout}>\n        <Paper className={classes.paper}>\n          <Typography variant=\"h4\" align=\"center\">Checkout</Typography>\n          <Stepper activeStep={activeStep} className={classes.stepper}>\n            {steps.map((label) => (\n              <Step key={label}>\n                <StepLabel>{label}</StepLabel>\n              </Step>\n            ))}\n          </Stepper>\n          {activeStep === steps.length ? <Confirmation /> : checkoutToken && <Form />}\n        </Paper>\n      </main>\n    </>\n  );\n};\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}